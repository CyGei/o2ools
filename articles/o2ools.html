<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Processing the output of outbreaker2 with o2ools • o2ools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Processing the output of outbreaker2 with o2ools">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">o2ools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/o2ools.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/extended_analyses.html">Extended analyses</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CyGei/o2ools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="o2ools_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="o2ools_files/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="o2ools_files/vis-9.1.0/vis-network.min.js"></script><script src="o2ools_files/visNetwork-binding-2.1.2/visNetwork.js"></script><link href="o2ools_files/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Processing the output of outbreaker2 with o2ools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CyGei/o2ools/blob/main/vignettes/o2ools.Rmd" class="external-link"><code>vignettes/o2ools.Rmd</code></a></small>
      <div class="d-none name"><code>o2ools.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">outbreaker2</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CyGei/o2ools" class="external-link">o2ools</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <em>o2ools</em> package provides helper functions to process and
summarise the results from <a href="https://www.repidemicsconsortium.org/outbreaker2/" class="external-link">outbreaker2</a>.<br></p>
<p>Below we use the default <code>fake_outbreak</code> example in the
<em>outbreaker2</em> vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The input data </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id         name   group onset sample</span></span>
<span><span class="co">#&gt; 1  1     Natashia     hcw     0      3</span></span>
<span><span class="co">#&gt; 2  2      Yesenia patient     2      5</span></span>
<span><span class="co">#&gt; 3  3 Abdul Kareem     hcw     4      6</span></span>
<span><span class="co">#&gt; 4  4        Logan     hcw     4      6</span></span>
<span><span class="co">#&gt; 5  5        Emily     hcw     6      7</span></span>
<span><span class="co">#&gt; 6  6       Shelby     hcw     6      9</span></span>
<span></span>
<span><span class="co"># outbreaker2 result</span></span>
<span><span class="va">out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ///// outbreaker results ///</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; class:  outbreaker_chains data.frame</span></span>
<span><span class="co">#&gt; dimensions 201 rows,  98 columns</span></span>
<span><span class="co">#&gt; ancestries not shown: alpha_1 - alpha_30</span></span>
<span><span class="co">#&gt; infection dates not shown: t_inf_1 - t_inf_30</span></span>
<span><span class="co">#&gt; intermediate generations not shown: kappa_1 - kappa_30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; /// head //</span></span>
<span><span class="co">#&gt;   step       post       like    prior           mu        pi       eps</span></span>
<span><span class="co">#&gt; 1    1 -1198.0669 -1199.4211 1.354240 0.0001000000 0.9000000 0.5000000</span></span>
<span><span class="co">#&gt; 2   50  -576.3898  -578.4358 2.046006 0.0001322360 0.9719080 0.6238018</span></span>
<span><span class="co">#&gt; 3  100  -579.1822  -580.9235 1.741283 0.0001218749 0.9395509 0.5810956</span></span>
<span><span class="co">#&gt;       lambda</span></span>
<span><span class="co">#&gt; 1 0.05000000</span></span>
<span><span class="co">#&gt; 2 0.06582716</span></span>
<span><span class="co">#&gt; 3 0.10193745</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ...</span></span>
<span><span class="co">#&gt; /// tail //</span></span>
<span><span class="co">#&gt;      step      post      like    prior           mu        pi       eps</span></span>
<span><span class="co">#&gt; 199  9900 -563.6538 -565.2708 1.616983 0.0001236515 0.9266639 0.7634021</span></span>
<span><span class="co">#&gt; 200  9950 -567.0488 -569.0806 2.031785 0.0001179255 0.9703719 0.7057554</span></span>
<span><span class="co">#&gt; 201 10000 -564.4037 -565.6457 1.242090 0.0001456115 0.8888590 0.6301657</span></span>
<span><span class="co">#&gt;         lambda</span></span>
<span><span class="co">#&gt; 199 0.07471296</span></span>
<span><span class="co">#&gt; 200 0.07418330</span></span>
<span><span class="co">#&gt; 201 0.08802858</span></span></code></pre></div>
<div class="section level3">
<h3 id="identify">Identify<a class="anchor" aria-label="anchor" href="#identify"></a>
</h3>
<p>By default <em>outbreaker2</em> will return a dataframe where each
case is referred to by an integer based on the order of the cases in the
linelist. The columns of this dataframe are named according to the
parameters of interest. For example, <code>t_inf_1</code> refers to the
infection time of case 1, <code>alpha_1</code> refers to the ancestor of
case 1, etc.</p>
<p>To swap-in our real case IDs, we use <code><a href="../reference/identify.html">identify()</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/identify.html">identify</a></span><span class="op">(</span><span class="va">out</span>, ids <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_id</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ///// outbreaker results ///</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; class:  outbreaker_chains data.frame</span></span>
<span><span class="co">#&gt; dimensions 6 rows,  98 columns</span></span>
<span><span class="co">#&gt; ancestries not shown: alpha_Natashia - alpha_Rabi</span></span>
<span><span class="co">#&gt; infection dates not shown: t_inf_Natashia - t_inf_Rabi</span></span>
<span><span class="co">#&gt; intermediate generations not shown: kappa_Natashia - kappa_Rabi</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; /// head //</span></span>
<span><span class="co">#&gt;   step       post       like    prior           mu        pi       eps</span></span>
<span><span class="co">#&gt; 1    1 -1198.0669 -1199.4211 1.354240 0.0001000000 0.9000000 0.5000000</span></span>
<span><span class="co">#&gt; 2   50  -576.3898  -578.4358 2.046006 0.0001322360 0.9719080 0.6238018</span></span>
<span><span class="co">#&gt; 3  100  -579.1822  -580.9235 1.741283 0.0001218749 0.9395509 0.5810956</span></span>
<span><span class="co">#&gt;       lambda</span></span>
<span><span class="co">#&gt; 1 0.05000000</span></span>
<span><span class="co">#&gt; 2 0.06582716</span></span>
<span><span class="co">#&gt; 3 0.10193745</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ...</span></span>
<span><span class="co">#&gt; /// tail //</span></span>
<span><span class="co">#&gt;   step      post      like    prior           mu        pi       eps     lambda</span></span>
<span><span class="co">#&gt; 4  150 -572.0877 -574.1242 2.036517 0.0001167833 0.9708822 0.6950082 0.05255790</span></span>
<span><span class="co">#&gt; 5  200 -583.3893 -585.6191 2.229780 0.0001288618 0.9919574 0.5482067 0.12669178</span></span>
<span><span class="co">#&gt; 6  250 -567.8580 -569.6462 1.788133 0.0001170668 0.9444540 0.7248895 0.05055557</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-individual-trees">Get individual trees<a class="anchor" aria-label="anchor" href="#get-individual-trees"></a>
</h3>
<p>To extract the individual trees from the posterior sample, we use
<code><a href="../reference/get_trees.html">get_trees()</a></code>. This function will return a list of trees, one
for each sample in the posterior. You can add additional
<em>outbreaker2</em> results to the trees, such as the infection times
(<code>t_inf</code>), the number of generations (<code>kappa</code>) and
other attributes from the linelist.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_trees.html">get_trees</a></span><span class="op">(</span><span class="va">out_id</span>, kappa <span class="op">=</span> <span class="cn">TRUE</span>, t_inf <span class="op">=</span> <span class="cn">TRUE</span>, group <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="co">#100th sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">trees</span><span class="op">[[</span><span class="fl">100</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;           from           to from_kappa to_kappa from_t_inf to_t_inf from_group</span></span>
<span><span class="co">#&gt; 1         &lt;NA&gt;     Natashia         NA       NA         NA       -1       &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2     Natashia      Yesenia         NA        1         -1        2        hcw</span></span>
<span><span class="co">#&gt; 3      Yesenia Abdul Kareem          1        1          2        3    patient</span></span>
<span><span class="co">#&gt; 4         &lt;NA&gt;        Logan         NA       NA         NA        2       &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5 Abdul Kareem        Emily          1        1          3        4        hcw</span></span>
<span><span class="co">#&gt; 6      Avenito       Shelby          1        1          6        8    patient</span></span>
<span><span class="co">#&gt;   to_group</span></span>
<span><span class="co">#&gt; 1      hcw</span></span>
<span><span class="co">#&gt; 2  patient</span></span>
<span><span class="co">#&gt; 3      hcw</span></span>
<span><span class="co">#&gt; 4      hcw</span></span>
<span><span class="co">#&gt; 5      hcw</span></span>
<span><span class="co">#&gt; 6      hcw</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h3>
<div class="section level4">
<h4 id="accuracy">Accuracy<a class="anchor" aria-label="anchor" href="#accuracy"></a>
</h4>
<p>Accuracy is the proportion of cases that are correctly identified
across the posterior sample. <strong>You can only use this function if
you have the true ancestry information for each case</strong>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">outbreaker2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/outbreaker2/man/fake_outbreak.html" class="external-link">fake_outbreak</a></span><span class="op">$</span><span class="va">ances</span><span class="op">)</span>,</span>
<span>  to   <span class="op">=</span> <span class="va">linelist</span><span class="op">$</span><span class="va">id</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_accuracy.html">get_accuracy</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">true_tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">accuracy</span><span class="op">)</span></span></code></pre></div>
<p><img src="o2ools_files/figure-html/unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="entropy">Entropy<a class="anchor" aria-label="anchor" href="#entropy"></a>
</h4>
<p>Entropy measures the uncertainty in a case’s ancestry. The more
potential ancestors a case has, the greater its entropy. By default,
entropy is bounded between 0 and 1, where 0 indicates no uncertainty
about a case’s ancestry, and 1 indicates maximum uncertainty.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">entropy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_entropy.html">get_entropy</a></span><span class="op">(</span><span class="va">out_id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span></span>
<span>  <span class="va">entropy</span>,</span>
<span>  horiz <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  las <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="o2ools_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
</div>
<div class="section level3">
<h3 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h3>
<div class="section level4">
<h4 id="augment-the-linelist-with-outbreaker2s-results">Augment the linelist with <em>outbreaker2</em>’s results<a class="anchor" aria-label="anchor" href="#augment-the-linelist-with-outbreaker2s-results"></a>
</h4>
<p>To add the results from <em>outbreaker2</em> to the linelist, we can
use <code><a href="../reference/augment_linelist.html">augment_linelist()</a></code>. This function will add summary
statistics for each case, such as the infection times inferred by
<em>outbreaker2</em>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># augment linelist with summaries of t_inf and kappa</span></span>
<span><span class="va">o2linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/augment_linelist.html">augment_linelist</a></span><span class="op">(</span></span>
<span>  <span class="va">out</span>, <span class="va">linelist</span>,</span>
<span>  params  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t_inf"</span>,<span class="st">"kappa"</span><span class="op">)</span>,</span>
<span>  summary_fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q25  <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    q75  <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">o2linelist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id         name   group onset sample t_inf_mean t_inf_q25 t_inf_q75</span></span>
<span><span class="co">#&gt; 1  1     Natashia     hcw     0      3 -0.6766169        -1         0</span></span>
<span><span class="co">#&gt; 2  2      Yesenia patient     2      5  1.2686567         1         2</span></span>
<span><span class="co">#&gt; 3  3 Abdul Kareem     hcw     4      6  2.6716418         2         3</span></span>
<span><span class="co">#&gt; 4  4        Logan     hcw     4      6  2.2835821         2         3</span></span>
<span><span class="co">#&gt; 5  5        Emily     hcw     6      7  4.0099502         4         4</span></span>
<span><span class="co">#&gt; 6  6       Shelby     hcw     6      9  7.7213930         7         8</span></span>
<span><span class="co">#&gt;   kappa_mean kappa_q25 kappa_q75</span></span>
<span><span class="co">#&gt; 1        NaN        NA        NA</span></span>
<span><span class="co">#&gt; 2    1.00995         1         1</span></span>
<span><span class="co">#&gt; 3    1.00000         1         1</span></span>
<span><span class="co">#&gt; 4        NaN        NA        NA</span></span>
<span><span class="co">#&gt; 5    1.00000         1         1</span></span>
<span><span class="co">#&gt; 6    1.00000         1         1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="consensus-tree">Consensus tree<a class="anchor" aria-label="anchor" href="#consensus-tree"></a>
</h4>
<p>A consensus tree represents, for each case, their most frequent
ancestor across the posterior sample. It provides a useful summary of
the results but may violate the strict topological constraints of a
tree, as it can include cycles (e.g. A is the most frequent ancestor of
B, but B is also the most frequent ancestor of A). Here,
<code>frequency</code> refers to the proportion of posterior samples in
which the infector–infectee pair appears.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">consensus_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_consensus.html">get_consensus</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">consensus_tree</span><span class="op">)</span></span>
<span><span class="co">#&gt;   from to frequency</span></span>
<span><span class="co">#&gt; 1 &lt;NA&gt;  1 1.0000000</span></span>
<span><span class="co">#&gt; 2    9 10 0.9950249</span></span>
<span><span class="co">#&gt; 3    7 11 0.8109453</span></span>
<span><span class="co">#&gt; 4    8 12 0.8358209</span></span>
<span><span class="co">#&gt; 5    9 13 1.0000000</span></span>
<span><span class="co">#&gt; 6    5 14 0.9900498</span></span></code></pre></div>
<p>We can plot the consensus tree using the augmented linelist and the
<em>epicontacts</em> package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.repidemicsconsortium.org/epicontacts/" class="external-link">epicontacts</a></span><span class="op">)</span></span>
<span><span class="va">epi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.repidemicsconsortium.org/epicontacts/reference/make_epicontacts.html" class="external-link">make_epicontacts</a></span><span class="op">(</span></span>
<span>  linelist <span class="op">=</span> <span class="va">o2linelist</span>,</span>
<span>  contacts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">consensus_tree</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co">#remove NA edges (i.e. imports)</span></span>
<span>  directed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># plot(epi) basic plot</span></span>
<span></span>
<span><span class="co"># colour setting</span></span>
<span><span class="va">epi</span><span class="op">$</span><span class="va">linelist</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">epi</span><span class="op">$</span><span class="va">linelist</span><span class="op">$</span><span class="va">group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcw"</span>, <span class="st">"patient"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">my_pal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"purple"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://www.repidemicsconsortium.org/epicontacts/reference/vis_epicontacts.html" class="external-link">vis_epicontacts</a></span><span class="op">(</span></span>
<span>  <span class="va">epi</span>,</span>
<span>  thin <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#show imports</span></span>
<span>  label <span class="op">=</span> <span class="st">"name"</span>,</span>
<span>  node_shape <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcw"</span> <span class="op">=</span> <span class="st">"user-md"</span>, <span class="st">"patient"</span> <span class="op">=</span> <span class="st">"bed"</span><span class="op">)</span>, <span class="co"># https://fontawesome.com/v4/icons/</span></span>
<span>  node_color <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  edge_arrow <span class="op">=</span> <span class="st">"to"</span>,</span>
<span>  col_pal       <span class="op">=</span> <span class="va">my_pal</span>,</span>
<span>  edge_col_pal  <span class="op">=</span> <span class="va">my_pal</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:90%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"nodes":{"id":["1","10","11","12","13","14","15","16","17","18","19","2","20","21","22","23","24","25","26","27","28","29","3","30","4","5","6","7","8","9"],"name":["Natashia","Avenito","Cyril","Demarco","Kaitlyn","Vanessa","Dania","Shendell","Michael","Dominique","Laaiqa","Yesenia","Cruzelia","Zaid","Micah","Christian","Stephanie","Kavita","Travis","Jacob","Lianne","Mariah","Abdul Kareem","Rabi","Logan","Emily","Shelby","Robert","Sahla","Tuhfa"],"group":["hcw","patient","patient","hcw","hcw","hcw","patient","patient","patient","hcw","patient","patient","hcw","hcw","hcw","patient","hcw","hcw","patient","patient","hcw","patient","hcw","hcw","hcw","hcw","hcw","patient","hcw","hcw"],"onset":[0,8,8,8,8,9,9,9,9,10,10,2,10,10,10,10,10,10,10,10,10,11,4,11,4,6,6,6,7,7],"sample":[3,9,11,10,10,10,10,11,11,12,11,5,13,12,13,11,12,11,11,13,12,14,6,14,6,7,9,8,9,9],"t_inf_mean":[-0.6766169154228856,6.472636815920398,7.308457711442786,7.512437810945274,6.651741293532338,7.009950248756219,7.263681592039801,7.835820895522388,7.303482587064677,8.865671641791044,7.940298507462686,1.268656716417911,9.830845771144279,9.656716417910447,10.16915422885572,8.691542288557214,9.373134328358208,8.691542288557214,9.074626865671641,10.09950248756219,9.124378109452737,10.16417910447761,2.671641791044776,10.28855721393035,2.283582089552239,4.009950248756219,7.721393034825871,4.641791044776119,5.810945273631841,5.039800995024875],"t_inf_q25":[-1,6,7,7,6,7,7,7,7,8,8,1,9,9,10,8,9,8,9,10,8,10,2,10,2,4,7,4,5,5],"t_inf_q75":[0,7,8,8,7,7,8,8,8,9,8,2,10,10,11,9,10,9,10,11,10,10,3,11,3,4,8,5,6,5],"kappa_mean":[null,1.014925373134328,1.104477611940299,1.00497512437811,1,1,1.009950248756219,1,1,1,1.00497512437811,1.009950248756219,1.079601990049751,1,1,1,1.009950248756219,1,1.009950248756219,1,null,1,1,1.009950248756219,null,1,1,1,1,1.283582089552239],"kappa_q25":[null,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,null,1,1,1,null,1,1,1,1,1],"kappa_q75":[null,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,null,1,1,1,null,1,1,1,1,2],"label":["Natashia","Avenito","Cyril","Demarco","Kaitlyn","Vanessa","Dania","Shendell","Michael","Dominique","Laaiqa","Yesenia","Cruzelia","Zaid","Micah","Christian","Stephanie","Kavita","Travis","Jacob","Lianne","Mariah","Abdul Kareem","Rabi","Logan","Emily","Shelby","Robert","Sahla","Tuhfa"],"title":["<p> id: 1<br>name: Natashia<br>group: hcw<br>onset: 0<br>sample: 3<br>t_inf_mean: -0.676616915422886<br>t_inf_q25: -1<br>t_inf_q75: 0<br>kappa_mean: NaN<br>kappa_q25: NA<br>kappa_q75: NA <\/p>","<p> id: 10<br>name: Avenito<br>group: patient<br>onset: 8<br>sample: 9<br>t_inf_mean: 6.4726368159204<br>t_inf_q25: 6<br>t_inf_q75: 7<br>kappa_mean: 1.01492537313433<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 11<br>name: Cyril<br>group: patient<br>onset: 8<br>sample: 11<br>t_inf_mean: 7.30845771144279<br>t_inf_q25: 7<br>t_inf_q75: 8<br>kappa_mean: 1.1044776119403<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 12<br>name: Demarco<br>group: hcw<br>onset: 8<br>sample: 10<br>t_inf_mean: 7.51243781094527<br>t_inf_q25: 7<br>t_inf_q75: 8<br>kappa_mean: 1.00497512437811<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 13<br>name: Kaitlyn<br>group: hcw<br>onset: 8<br>sample: 10<br>t_inf_mean: 6.65174129353234<br>t_inf_q25: 6<br>t_inf_q75: 7<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 14<br>name: Vanessa<br>group: hcw<br>onset: 9<br>sample: 10<br>t_inf_mean: 7.00995024875622<br>t_inf_q25: 7<br>t_inf_q75: 7<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 15<br>name: Dania<br>group: patient<br>onset: 9<br>sample: 10<br>t_inf_mean: 7.2636815920398<br>t_inf_q25: 7<br>t_inf_q75: 8<br>kappa_mean: 1.00995024875622<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 16<br>name: Shendell<br>group: patient<br>onset: 9<br>sample: 11<br>t_inf_mean: 7.83582089552239<br>t_inf_q25: 7<br>t_inf_q75: 8<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 17<br>name: Michael<br>group: patient<br>onset: 9<br>sample: 11<br>t_inf_mean: 7.30348258706468<br>t_inf_q25: 7<br>t_inf_q75: 8<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 18<br>name: Dominique<br>group: hcw<br>onset: 10<br>sample: 12<br>t_inf_mean: 8.86567164179104<br>t_inf_q25: 8<br>t_inf_q75: 9<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 19<br>name: Laaiqa<br>group: patient<br>onset: 10<br>sample: 11<br>t_inf_mean: 7.94029850746269<br>t_inf_q25: 8<br>t_inf_q75: 8<br>kappa_mean: 1.00497512437811<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 2<br>name: Yesenia<br>group: patient<br>onset: 2<br>sample: 5<br>t_inf_mean: 1.26865671641791<br>t_inf_q25: 1<br>t_inf_q75: 2<br>kappa_mean: 1.00995024875622<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 20<br>name: Cruzelia<br>group: hcw<br>onset: 10<br>sample: 13<br>t_inf_mean: 9.83084577114428<br>t_inf_q25: 9<br>t_inf_q75: 10<br>kappa_mean: 1.07960199004975<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 21<br>name: Zaid<br>group: hcw<br>onset: 10<br>sample: 12<br>t_inf_mean: 9.65671641791045<br>t_inf_q25: 9<br>t_inf_q75: 10<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 22<br>name: Micah<br>group: hcw<br>onset: 10<br>sample: 13<br>t_inf_mean: 10.1691542288557<br>t_inf_q25: 10<br>t_inf_q75: 11<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 23<br>name: Christian<br>group: patient<br>onset: 10<br>sample: 11<br>t_inf_mean: 8.69154228855721<br>t_inf_q25: 8<br>t_inf_q75: 9<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 24<br>name: Stephanie<br>group: hcw<br>onset: 10<br>sample: 12<br>t_inf_mean: 9.37313432835821<br>t_inf_q25: 9<br>t_inf_q75: 10<br>kappa_mean: 1.00995024875622<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 25<br>name: Kavita<br>group: hcw<br>onset: 10<br>sample: 11<br>t_inf_mean: 8.69154228855721<br>t_inf_q25: 8<br>t_inf_q75: 9<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 26<br>name: Travis<br>group: patient<br>onset: 10<br>sample: 11<br>t_inf_mean: 9.07462686567164<br>t_inf_q25: 9<br>t_inf_q75: 10<br>kappa_mean: 1.00995024875622<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 27<br>name: Jacob<br>group: patient<br>onset: 10<br>sample: 13<br>t_inf_mean: 10.0995024875622<br>t_inf_q25: 10<br>t_inf_q75: 11<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 28<br>name: Lianne<br>group: hcw<br>onset: 10<br>sample: 12<br>t_inf_mean: 9.12437810945274<br>t_inf_q25: 8<br>t_inf_q75: 10<br>kappa_mean: NaN<br>kappa_q25: NA<br>kappa_q75: NA <\/p>","<p> id: 29<br>name: Mariah<br>group: patient<br>onset: 11<br>sample: 14<br>t_inf_mean: 10.1641791044776<br>t_inf_q25: 10<br>t_inf_q75: 10<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 3<br>name: Abdul Kareem<br>group: hcw<br>onset: 4<br>sample: 6<br>t_inf_mean: 2.67164179104478<br>t_inf_q25: 2<br>t_inf_q75: 3<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 30<br>name: Rabi<br>group: hcw<br>onset: 11<br>sample: 14<br>t_inf_mean: 10.2885572139303<br>t_inf_q25: 10<br>t_inf_q75: 11<br>kappa_mean: 1.00995024875622<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 4<br>name: Logan<br>group: hcw<br>onset: 4<br>sample: 6<br>t_inf_mean: 2.28358208955224<br>t_inf_q25: 2<br>t_inf_q75: 3<br>kappa_mean: NaN<br>kappa_q25: NA<br>kappa_q75: NA <\/p>","<p> id: 5<br>name: Emily<br>group: hcw<br>onset: 6<br>sample: 7<br>t_inf_mean: 4.00995024875622<br>t_inf_q25: 4<br>t_inf_q75: 4<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 6<br>name: Shelby<br>group: hcw<br>onset: 6<br>sample: 9<br>t_inf_mean: 7.72139303482587<br>t_inf_q25: 7<br>t_inf_q75: 8<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 7<br>name: Robert<br>group: patient<br>onset: 6<br>sample: 8<br>t_inf_mean: 4.64179104477612<br>t_inf_q25: 4<br>t_inf_q75: 5<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 8<br>name: Sahla<br>group: hcw<br>onset: 7<br>sample: 9<br>t_inf_mean: 5.81094527363184<br>t_inf_q25: 5<br>t_inf_q75: 6<br>kappa_mean: 1<br>kappa_q25: 1<br>kappa_q75: 1 <\/p>","<p> id: 9<br>name: Tuhfa<br>group: hcw<br>onset: 7<br>sample: 9<br>t_inf_mean: 5.03980099502488<br>t_inf_q25: 5<br>t_inf_q75: 5<br>kappa_mean: 1.28358208955224<br>kappa_q25: 1<br>kappa_q75: 2 <\/p>"],"color":["orange","purple","purple","orange","orange","orange","purple","purple","purple","orange","purple","purple","orange","orange","orange","purple","orange","orange","purple","purple","orange","purple","orange","orange","orange","orange","orange","purple","orange","orange"],"shape":["icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon"],"icon.code":["f0f0","f236","f236","f0f0","f0f0","f0f0","f236","f236","f236","f0f0","f236","f236","f0f0","f0f0","f0f0","f236","f0f0","f0f0","f236","f236","f0f0","f236","f0f0","f0f0","f0f0","f0f0","f0f0","f236","f0f0","f0f0"],"icon.color":["orange","purple","purple","orange","orange","orange","purple","purple","purple","orange","purple","purple","orange","orange","orange","purple","orange","orange","purple","purple","orange","purple","orange","orange","orange","orange","orange","purple","orange","orange"]},"edges":{"from":["9","7","8","9","5","5","7","7","8","9","1","10","11","11","13","13","13","17","17","10","2","13","3","10","4","5","4"],"to":["10","11","12","13","14","15","16","17","18","19","2","20","21","22","23","24","25","26","27","29","3","30","5","6","7","8","9"],"frequency":[0.9950248756218906,0.8109452736318408,0.835820895522388,1,0.9900497512437811,0.7263681592039801,0.9950248756218906,0.9701492537313433,0.9651741293532339,1,1,1,1,1,1,1,1,0.9751243781094527,1,1,1,1,1,0.9950248756218906,1,0.9601990049751243,0.9502487562189055],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":false}},"groups":["hcw","patient"],"width":"90%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["hcw","patient"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["hcw","patient"],"color":["orange","purple"],"shape":["box","box"],"shadow":[true,true],"font.size":[20,20]},"nodesToDataframe":true},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script><p>Or we can convert the tree to an <em>igraph</em>/<em>tidygraph</em>
object and plot it using the <em>ggraph</em> package.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">epicontacts</span><span class="fu">:::</span><span class="fu"><a href="https://www.repidemicsconsortium.org/epicontacts/reference/as.igraph.epicontacts.html" class="external-link">as.igraph.epicontacts</a></span><span class="op">(</span><span class="va">epi</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html" class="external-link">as_tbl_graph</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">layout_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">create_layout</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">'kk'</span><span class="op">)</span></span>
<span><span class="va">layout_data</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">layout_data</span><span class="op">$</span><span class="va">onset</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="va">layout_data</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html" class="external-link">geom_edge_link</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      edge_width <span class="op">=</span> <span class="va">frequency</span>,</span>
<span>      color <span class="op">=</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/context_accessors.html" class="external-link">.N</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="va">from</span><span class="op">]</span> <span class="co"># .N() to accesses node data</span></span>
<span>    <span class="op">)</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html" class="external-link">circle</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">'mm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, </span>
<span>    shape <span class="op">=</span> <span class="fl">21</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html" class="external-link">geom_node_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">epicontacts_name</span><span class="op">)</span>,</span>
<span>    repel <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">3</span>, nudge_y <span class="op">=</span> <span class="fl">0.1</span>, bg.color <span class="op">=</span> <span class="st">"white"</span>, bg.r <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_width.html" class="external-link">scale_edge_width</a></span><span class="op">(</span><span class="st">"Posterior support"</span>,</span>
<span>                   range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                   breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    <span class="st">""</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcw"</span> <span class="op">=</span> <span class="st">"orange"</span>, <span class="st">"patient"</span> <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcw"</span>, <span class="st">"patient"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/scale_edge_colour.html" class="external-link">scale_edge_colour_manual</a></span><span class="op">(</span></span>
<span>    <span class="st">""</span>,</span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcw"</span> <span class="op">=</span> <span class="st">"orange"</span>, <span class="st">"patient"</span> <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span>,</span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcw"</span>, <span class="st">"patient"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Onset date"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="o2ools_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
<div class="section level4">
<h4 id="maximum-posterior-tree">Maximum posterior tree<a class="anchor" aria-label="anchor" href="#maximum-posterior-tree"></a>
</h4>
<p>The maximum posterior tree is the single most likely transmission
tree, corresponding to the MCMC iteration with the highest posterior
probability. You can extract it as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_post</span> <span class="op">&lt;-</span> <span class="va">trees</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">post</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co">#Same as before, create and plot an epicontacts object</span></span>
<span><span class="va">epi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://www.repidemicsconsortium.org/epicontacts/reference/make_epicontacts.html" class="external-link">make_epicontacts</a></span><span class="op">(</span></span>
<span>  linelist <span class="op">=</span> <span class="va">o2linelist</span>,</span>
<span>  contacts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">max_post</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">from</span><span class="op">)</span><span class="op">)</span>, <span class="co">#remove NA edges (i.e. imports)</span></span>
<span>  directed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can also use <code><a href="../reference/filter_chain.html">filter_chain()</a></code> to restrict the output
to “trees” that meet a specific condition. For instance, to keep only
direct transmissions (i.e. <code>kappa == 1</code>), run:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_chain.html">filter_chain</a></span><span class="op">(</span><span class="va">out</span>, param <span class="op">=</span> <span class="st">"kappa"</span>, thresh <span class="op">=</span> <span class="fl">1</span>, comparator <span class="op">=</span> <span class="st">"=="</span>, target <span class="op">=</span> <span class="st">"alpha"</span><span class="op">)</span></span></code></pre></div>
<p>This <strong>masks</strong> any transmission links involving
intermediate cases, allowing you to focus on direct infector–infectee
pairs.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-analyses">Additional analyses<a class="anchor" aria-label="anchor" href="#additional-analyses"></a>
</h2>
<p>For additional analyses check the other vignettes on the package’s
website.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cyril Geismar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
